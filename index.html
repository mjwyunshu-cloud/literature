<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文学原型测试 | 世界作家人格分析</title>
    <!-- 基础库 CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Serif SC', serif;
            background-color: #f2f0e9;
            color: #3a3833;
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
        }
        .animate-fade-in { animation: fadeIn 1s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        
        .handwritten-note {
            font-family: 'cursive', sans-serif;
            color: #d14d42;
            font-size: 0.75rem;
            transform: rotate(-3deg);
            display: inline-block;
        }
        
        .highlight-yellow {
            background: linear-gradient(180deg, rgba(255,255,255,0) 50%, #e8ed2a 50%);
            padding: 0 4px;
        }

        .redeem-input {
            background: transparent;
            border: none;
            border-bottom: 1.5px solid #3a3833;
            outline: none;
            text-align: center;
            letter-spacing: 0.2em;
            transition: all 0.3s;
        }
        .redeem-input:focus { border-bottom: 2px solid #35afcb; }
        .shake { animation: shake 0.4s ease-in-out; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        
        ::-webkit-scrollbar { width: 0px; background: transparent; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // 1. 配置常量
        const COLORS = { 
            bg: "#f2f0e9", 
            textMain: "#3a3833", 
            textSecondary: "#6d6b64", 
            accentYellow: "#e8ed2a", 
            accentBlue: "#35afcb", 
            accentGreen: "#a4c29b", 
            border: "#dcd8cf" 
        };

        const ARCHETYPES = {
            REBEL: {
                name: "弗朗茨·卡夫卡", sub: "异化与反叛的审判官",
                identity: "倾向于在荒诞的规则中进行无止尽的个人突围。",
                anxiety: "害怕被庞大的、不可见的力量彻底异化。",
                shadow: "过度自我封闭可能陷入永恒的、无法抵达目的地的焦虑。",
                resonance: { mate: "黑塞", rival: "博尔赫斯" },
                quote: "在这个荒谬的世界，即便变成甲虫，也要保持思考的尊严。",
                quoteSource: "卡夫卡《变形记》",
                stats: [95, 45, 80, 50, 75],
                longDesc: "你的精神内核与卡夫卡同频。你对生活中的‘理所当然’持有生理性的警惕。文学对你而言不是避风港，而是揭露真实荒诞性的手术刀。你在文字中不断重复着推墙的动作，虽然墙未必会塌，但推墙本身确立了你的主体性。",
                books: [{ title: "《变形记》", author: "卡夫卡", desc: "关于人如何被异化以及在异化中寻找自我的终极寓言。" }, { title: "《审判》", author: "卡夫卡", desc: "在不可理喻的生存处境中面对命运的非法指控。" }]
            },
            SAGE: {
                name: "豪尔赫·博尔赫斯", sub: "逻辑迷宫的筑造者",
                identity: "视世界为一座由符号、典籍和无限分岔路口构成的图书馆。",
                anxiety: "害怕叙事逻辑的坍塌，害怕面对那些无法被理性和百科全书解释的混沌。",
                shadow: "容易陷入极度的智性傲慢，用逻辑的精微来掩盖情感的荒芜。",
                resonance: { mate: "海明威", rival: "伍尔夫" },
                quote: "我心里一直都在暗暗设想，天堂应该是图书馆的模样。",
                quoteSource: "博尔赫斯《关于天赐之诗》",
                stats: [40, 98, 35, 85, 60],
                longDesc: "你倾向于博尔赫斯式的智性审美。在你眼中万物皆是隐喻。你迷恋精密的结构、镜子与迷宫，因为看透本质带来的超脱感是你最核心的驱动力。文学对你而言是一场博弈，是你构建宇宙秩序的智力游戏。",
                books: [{ title: "《小径分岔的花园》", author: "博尔赫斯", desc: "在文字的时空折叠中，体验无限可能的交汇与错失。" }, { title: "《虚构集》", author: "博尔赫斯", desc: "彻底打破现实与幻想的边界，用思想实验解构世界。" }]
            },
            IDEALIST: {
                name: "弗吉尼亚·伍尔夫", sub: "内在意识的流浪诗人",
                identity: "捕捉那些转瞬即逝的颤动，在时间的切片中寻找神性。",
                anxiety: "感到外部世界的粗鄙与吵闹，害怕灵魂的敏感被生活琐碎所玷污。",
                shadow: "沉溺于精神的潮汐，可能由于无法在现实落脚而走向脆弱的毁灭。",
                resonance: { mate: "黑塞", rival: "博尔赫斯" },
                quote: "不必行色匆匆，不必闪耀光芒，不必成为任何人，只需做你自己。",
                quoteSource: "伍尔夫《一间自己的房间》",
                stats: [35, 60, 50, 45, 98],
                longDesc: "你具有伍尔夫式的细腻敏锐。你坚信‘美即是真’，文学是你逃离平庸日常的诺亚方舟。你不仅记录生活，你更在词藻中重构一个比现实更纯粹、更神性的精神空间。你的力量源于对每一个瞬间之美的极致守护。",
                books: [{ title: "《到灯塔去》", author: "伍尔夫", desc: "在情感的涟漪与时间的流逝中，完成一场对永恒的试探。" }, { title: "《达洛维夫人》", author: "伍尔夫", desc: "于平凡的一天中，剖析灵魂深处如群星般闪耀的瞬间。" }]
            },
            WANDERER: {
                name: "赫尔曼·黑塞", sub: "归乡途中的永恒流浪者",
                identity: "身份是在不断的行走与试错中被‘发明’出来的。",
                anxiety: "害怕任何形式的定居与安稳，认为每一个终点都可能是自我的枷锁。",
                shadow: "缺乏深度的世俗联结，可能由于过度的精神自由而感到彻骨的寒冷。",
                resonance: { mate: "卡夫卡", rival: "海明威" },
                quote: "我不是一个说故事的人。我只是一个探索者，一个流浪者。",
                quoteSource: "黑塞《德米安》",
                stats: [65, 50, 75, 98, 45],
                longDesc: "你对应着黑塞式的苦行与漫游。你不在乎目的地，你在乎的是风吹过发梢时那份自我的完整。你认为文学不是家园，而是通向地平线的地图。你最好的作品，永远写在前往下一个驿站的路上。",
                books: [{ title: "《悉达多》", author: "黑塞", desc: "一场关于寻找自我、超越轮回的终极精神修行。" }, { title: "《荒原狼》", author: "黑塞", desc: "在文明的废墟与人性的挣扎中，寻找灵魂的平衡点。" }]
            },
            HERO: {
                name: "欧内斯特·海明威", sub: "宿命重压下的尊严硬汉",
                identity: "在明知结局会‘陨落’的前提下，选择挺身而出完成使命。",
                anxiety: "害怕意志的枯竭，害怕在那场必败的战争中显露出哪怕一秒的怯懦。",
                shadow: "容易被壮烈的崇高感所绑架，从而忽视了平凡生活中温情与柔弱的价值。",
                resonance: { mate: "博尔赫斯", rival: "黑塞" },
                quote: "一个人可以被毁灭，但不能被击败。",
                quoteSource: "海明威《老人与海》",
                stats: [85, 70, 55, 55, 90],
                longDesc: "你对应着海明威式的生命意志。你理解世界的残酷与荒谬，但你选择在必然的‘毁灭’中确立人的尊严。文学对你而言是祭坛，是勇气的最终见证。你并不畏惧失败，你只畏惧过程的怯懦与平庸。",
                books: [{ title: "《老人与海》", author: "海明威", desc: "人可以被打死，但不能被打败——生命尊严的终极赞歌。" }, { title: "《太阳照常升起》", author: "海明威", desc: "在幻灭感肆虐的迷惘时代，寻找行动的意义与风度。" }]
            }
        };

        const QUESTIONS = [
            { id: 1, text: "在卡夫卡的《法门前》，你面对那扇为你而开却从未进入的门，你会：", options: [
                { text: "一直坐着等到老死，直到看清守门人的虚妄", type: "REBEL" },
                { text: "起身离开，不再寻求那个被预设的“法”", type: "WANDERER" },
                { text: "研究守门人的衣褶和语速，试图推演其逻辑", type: "SAGE" },
                { text: "向守门人祈祷，为那份不可及的秩序写一首哀歌", type: "IDEALIST" }
            ]},
            { id: 2, text: "你进入博尔赫斯的《巴别图书馆》，在无限的书架中，你寻找：", options: [
                { text: "那本包含所有书目索引的、被称为“总目录”的神书", type: "SAGE" },
                { text: "撕碎那些毫无意义的乱码，在废墟中确立自我的语言", type: "REBEL" },
                { text: "每一页都通向不同时空的、随风翻动的旅行日志", type: "WANDERER" },
                { text: "辞藻华丽到近乎透明、能映照出我灵魂初心的残页", type: "IDEALIST" }
            ]},
            { id: 3, text: "海明威的圣地亚哥正面对夺走马林鱼的鲨鱼群，此时你笔下的角色会：", options: [
                { text: "握紧带有锈迹的鱼叉，在必败的宿命里刺出最后一击", type: "HERO" },
                { text: "冷眼观察鲨鱼的咬痕，记录下这场关于弱肉强食的闭环", type: "SAGE" },
                { text: "割断绳索，将残骨留给大海，空手驶向未知的地平线", type: "WANDERER" },
                { text: "闭上眼，在脑海中重现马林鱼跃出水面时的神性之美", type: "IDEALIST" }
            ]},
            { id: 4, text: "伍尔夫的达洛维夫人正在准备晚宴，而你作为其中的一位客人，你感到：", options: [
                { text: "每一个寒暄的间隙，都是意识在时间的切片中剧烈颤动", type: "IDEALIST" },
                { text: "这不过是一场权力的戏仿，你随时准备推窗跳入黑夜", type: "REBEL" },
                { text: "分析宾客们的微表情，试图解开社交符号背后的深意", type: "SAGE" },
                { text: "厌倦了华丽的丝绸，你渴望明天就启程前往远方的塔楼", type: "WANDERER" }
            ]},
            { id: 5, text: "在黑塞的西达多身旁，你凝视着那条流动的河。你听到了：", options: [
                { text: "千万个自我的声音在河流中交汇，终归于无差别的宁静", type: "WANDERER" },
                { text: "一条由于因果律不断重复、毫无自由可言的循环系统", type: "SAGE" },
                { text: "那是对岸英雄战斗的鼓角，在宿命的波浪里发出回响", type: "HERO" },
                { text: "一朵从未存在过的、纯净到让人心颤的倒影之花", type: "IDEALIST" }
            ]},
            { id: 6, text: "当你发现自己身处《城堡》之中，那位从未露面的伯爵命令你顺从：", options: [
                { text: "在官僚主义的泥淖里反复纠缠，直到将其荒诞性推向极致", type: "REBEL" },
                { text: "把这当成一场复杂的解码游戏，寻找进入权力的逻辑漏洞", type: "SAGE" },
                { text: "直接背过身去，城堡只是你漫长旅途中的一个偶然参照", type: "WANDERER" },
                { text: "即使宿命不可更改，也要在寒冷的雪地里守住人的尊严", type: "HERO" }
            ]},
            { id: 7, text: "一个老巫师在《地狱之季》的入口处要你交出“一半灵魂”换取灵感：", options: [
                { text: "“我的灵魂早已属于荒原，你没有任何可以交换的东西”", type: "WANDERER" },
                { text: "分析契约的风险与回报率，试图寻找交易背后的公理", type: "SAGE" },
                { text: "直接烧了契约：反叛者的创造力来源于痛苦而非交换", type: "REBEL" },
                { text: "用剩下的灵魂写一首祭奠这份牺牲的唯美挽歌", type: "IDEALIST" }
            ]},
            { id: 8, text: "博尔赫斯的《阿莱夫》就在你眼前，一个包含宇宙所有角落的点：", options: [
                { text: "盯着它直到双眼酸痛，试图建立一套全知全能的索引系统", type: "SAGE" },
                { text: "意识到这种绝对的真相是一种禁锢，转身去寻找局部的自由", type: "WANDERER" },
                { text: "打碎它：这种神的视角是对人类主体性的傲慢挑衅", type: "REBEL" },
                { text: "迷恋它瞬间折射出的、如晚霞般消逝的感官涟漪", type: "IDEALIST" }
            ]},
            { id: 9, text: "如果你被囚禁在哥特式地牢，而明天就要面对必死的审判，你会：", options: [
                { text: "在石壁上刻下对这腐朽法治的最后一记响亮的耳光", type: "REBEL" },
                { text: "整理思绪，在脑海里完成最后一次逻辑自洽的思想实验", type: "SAGE" },
                { text: "在墙角画一朵从未见过的、带着露水的诗意玫瑰", type: "IDEALIST" },
                { text: "坦然穿上最重的甲胄，向那个必将到来的终点致敬", type: "HERO" }
            ]},
            { id: 10, text: "你正在创作《到灯塔去》，但灯塔似乎永远无法抵达。你的态度是：", options: [
                { text: "“灯塔是否抵达不重要，重要的是此时此刻意识的流淌”", type: "IDEALIST" },
                { text: "“只要船舵还在我手里，我就从未在暴雨中落败过”", type: "HERO" },
                { text: "“灯塔只是一个虚假的符号，其背后逻辑值得被拆解”", type: "SAGE" },
                { text: "“我已经习惯了永远在路上，灯塔只是一个临时驿站”", type: "WANDERER" }
            ]},
            { id: 11, text: "在卡夫卡的法庭里，你从未被告知罪名。你的辩护策略是：", options: [
                { text: "以最大的疯狂反诉这法治本身的非法性", type: "REBEL" },
                { text: "试图从繁琐的案卷中理清一套根本不存在的运作规律", type: "SAGE" },
                { text: "沉默，因为在这个荒诞处境里，任何语言都是亵渎", type: "WANDERER" },
                { text: "在冰冷的审判席上，回忆起童年一个纯真到近乎神性的午后", type: "IDEALIST" }
            ]},
            { id: 12, text: "黑塞的“魔幻剧场”门上写着：仅供疯子。你会：", options: [
                { text: "笑着走进去，因为你深知正常的灵魂都是一潭死水", type: "WANDERER" },
                { text: "在门口分析这种标签化的心理机制，寻找进入的算法", type: "SAGE" },
                { text: "撕掉那个告示，没人有权定义谁是“疯子”", type: "REBEL" },
                { text: "带上一面镜子，去观看灵魂内部那场唯美而忧郁的潮汐", type: "IDEALIST" }
            ]},
            { id: 13, text: "如果你的文学对手是海明威笔下的斗牛士，你希望他：", options: [
                { text: "在牛角刺入胸膛的一刻，依然保持着最冷静的风度", type: "HERO" },
                { text: "成为我智性的镜像，在逻辑的巅峰与我进行零和博弈", type: "SAGE" },
                { text: "突然扔下长剑，在那场充满血腥的表演中完成一次突围", type: "REBEL" },
                { text: "成为我理想人格的化身，替我在尘埃中寻找纯洁感", type: "IDEALIST" }
            ]},
            { id: 14, text: "在一本博尔赫斯的神秘典籍中，你发现自己的人生已被写死：", options: [
                { text: "这说明宿命是一个闭环，这套系统具有极致的稳定美", type: "SAGE" },
                { text: "哪怕只有最后一页，我也要亲手改写最后那一个字", type: "REBEL" },
                { text: "合上书，既然结局已定，过程的流浪就变得更加自由", type: "WANDERER" },
                { text: "在字里行间撒下彩色的墨水，模糊掉那个冷酷的句号", type: "IDEALIST" }
            ]},
            { id: 15, text: "伍尔夫的“一间自己的房间”里，最重要的陈设应当是：", options: [
                { text: "一扇永远敞向花园、能听见潮汐声的透明窗户", type: "IDEALIST" },
                { text: "一张总是装满草稿、随时准备拎走的破旧写字台", type: "WANDERER" },
                { text: "一台精确运行、毫无情感偏私的打字机", type: "SAGE" },
                { text: "一把拒绝任何人坐下的、带刺且具有攻击性的铁椅", type: "REBEL" }
            ]},
            { id: 16, text: "海明威式的“胜利”在一场惨烈的战争中降临，你内心的感受是：", options: [
                { text: "“人可以被毁灭，但不能被击败”，这是一种神圣悲情", type: "HERO" },
                { text: "看透了胜利背后的荒谬，由于彻底洞察而感到一阵虚无", type: "WANDERER" },
                { text: "这就是摧毁旧秩序、粉碎虚伪秩序后的极致快慰", type: "REBEL" },
                { text: "胜利只是一个参数的闭环，并不意味着感性的终结", type: "SAGE" }
            ]},
            { id: 17, text: "关于“叙述者”的语气，你更倾向于模仿：", options: [
                { text: "海明威式的电报体：简练、克制，文字里流淌着血迹", type: "HERO" },
                { text: "卡夫卡式的冷峻调子：像法官在记录一场非法的梦境", type: "REBEL" },
                { text: "伍尔夫式的碎碎念：意识在时空的切片中喃喃自语", type: "IDEALIST" },
                { text: "博尔赫斯式的百科全书：冷静地引用着不存在的典籍", type: "SAGE" }
            ]},
            { id: 18, text: "在黑塞笔下的荒原中，你遇到一只濒死的老狼：", options: [
                { text: "它是你孤独意志的对照，你蹲下身，与它共度最后一晚", type: "WANDERER" },
                { text: "解剖它的本能，看看这种野性在社会化进程中如何枯萎", type: "SAGE" },
                { text: "由于这种生理性的异化感到了极大的羞辱，向天咒骂", type: "REBEL" },
                { text: "将其安葬，并摘下一朵野花，记录这唯美而残酷的消亡", type: "IDEALIST" }
            ]},
            { id: 19, text: "对于文学中的“神秘主义”和“不可知论”，你的态度是：", options: [
                { text: "“神秘是审美的温床，解释清楚了，美也就凋谢了”", type: "IDEALIST" },
                { text: "“神秘只是理性的边疆，总有一天所有迷雾都会被穿透”", type: "SAGE" },
                { text: "“神秘是真理的掩体，我们要用反叛的手法逼出真相”", type: "REBEL" },
                { text: "“神秘是地平线，我们永远在追逐，但从未真正抵达”", type: "WANDERER" }
            ]},
            { id: 20, text: "最后，如果你必须在《巴黎是一场流动的盛宴》中离开，你会选择：", options: [
                { text: "喝完那口苦涩的黑咖啡，头也不回地走向下一个异乡", type: "WANDERER" },
                { text: "紧紧抱住那个在这个时代显得不完美的自己，悄然谢幕", type: "HERO" },
                { text: "记录下所有宾客的数据，作为这个文明最后消逝的存证", type: "SAGE" },
                { text: "大笑三声，嘲讽这所谓的盛宴终究只是一场荒唐的剧终", type: "REBEL" }
            ]},
            { id: 21, text: "一个博尔赫斯式的“叙事黑洞”正在吞噬你的结局：", options: [
                { text: "站在引力边缘，冷静记录逻辑符号的扭曲率", type: "SAGE" },
                { text: "在被吞噬前，对着虚无发出最后一声狂笑", type: "REBEL" },
                { text: "纵身一跃，看看黑洞另一端的未知宇宙是否自由", type: "WANDERER" },
                { text: "用华丽的词藻修饰这场崩塌，让陨落也显得高贵", type: "IDEALIST" }
            ]},
            { id: 22, text: "你在文本荒漠中发现一朵永不凋零的“塑料花”：", options: [
                { text: "分析它的分子结构，思考它如何欺骗了人类的感官", type: "SAGE" },
                { text: "愤怒于这种廉价的永恒，亲手将其埋入沙土深处", type: "REBEL" },
                { text: "把它带走，作为对失落工业文明的一次唯美怀旧", type: "IDEALIST" },
                { text: "看一眼就走，假的东西即便永恒也毫无重量", type: "WANDERER" }
            ]},
            { id: 23, text: "如果文字有气味，你笔下的叙事更接近：", options: [
                { text: "福尔马林：冷静、洁净、具有解剖质感的理性", type: "SAGE" },
                { text: "火药与灰烬：带有破坏秩序后的余温", type: "REBEL" },
                { text: "旧报纸与丁香：一种极其细腻且忧郁的感官记忆", type: "IDEALIST" },
                { text: "咸涩的海风：自由、广阔且带着孤独的野性", type: "WANDERER" }
            ]},
            { id: 24, text: "你在页边距里发现了一个“微型国家”，你认为：", options: [
                { text: "这是正文逻辑之外的非法寄生，应当被肃清", type: "REBEL" },
                { text: "这是主体性的一块自留地，是抗衡宏大的堡垒", type: "HERO" },
                { text: "这是文本的偶然溢出，体现了语言的不稳定性", type: "SAGE" },
                { text: "这是我一直寻找的乌托邦，在这里我不再是被叙述的人", type: "IDEALIST" }
            ]},
            { id: 25, text: "如果时间可以作为一种纸张，你会在上面涂抹：", options: [
                { text: "无数个向后连接的箭头，编织一张庞大的逻辑网", type: "SAGE" },
                { text: "一道道深邃的划痕，记录对抗衰老的尊严疤痕", type: "HERO" },
                { text: "漫无目的的线条，随风飘向空白处", type: "WANDERER" },
                { text: "一层又一层半透明的彩墨，构建虚幻的厚度", type: "IDEALIST" }
            ]},
            { id: 26, text: "文字最终的形态应当是：", options: [
                { text: "一把燃烧的火炬，点燃读者的同时也毁灭自己", type: "REBEL" },
                { text: "一个完美的圆环，首尾相接，逻辑自闭且神圣", type: "SAGE" },
                { text: "一条延伸至地平线尽头的、模糊的直线", type: "WANDERER" },
                { text: "一片散落在虚空中的、发光的羽毛", type: "IDEALIST" }
            ]},
            { id: 27, text: "你笔下的主角面对神灵的沉默，他的回答是：", options: [
                { text: "拔出剑，向那沉默的苍穹发起必败的挑战", type: "HERO" },
                { text: "笑出声，意识到神灵只是逻辑的伪命题", type: "SAGE" },
                { text: "转身走入沙漠，在那神灵不曾触及的沙丘中流浪", type: "WANDERER" },
                { text: "用诗篇去填满神灵的空位，创造自己的神圣瞬间", type: "IDEALIST" }
            ]},
            { id: 28, text: "如果文字世界坍塌了，只剩下一个词，你希望是：", options: [
                { text: "“但是”，永远代表反抗与转折的可能", type: "REBEL" },
                { text: "“因为”，即使毁灭也要守住因果的底线", type: "SAGE" },
                { text: "“也许”，保留审美中那种朦胧的余地", type: "IDEALIST" },
                { text: "“再会”，预示着下一场未知的启程", type: "WANDERER" }
            ]},
            { id: 29, text: "你被要求为历史写一段注脚，你选择：", options: [
                { text: "拆解那些辉煌词藻下的权力本质，揭穿谎言", type: "REBEL" },
                { text: "总结文明演变的公理，让规律在文字中永存", type: "SAGE" },
                { text: "为每一个被遗忘的个体写一首葬歌，守护温柔", type: "IDEALIST" },
                { text: "告诉后人，除了所谓的历史，旷野还有自由", type: "WANDERER" }
            ]},
            { id: 30, text: "如果你灵魂是一件文学圣器，它应该是：", options: [
                { text: "一把能剖开一切伪善的利刃", type: "REBEL" },
                { text: "一架能观测星体运行轨迹的望远镜", type: "SAGE" },
                { text: "一个能装下整片晚霞的墨水瓶", type: "IDEALIST" },
                { text: "一张永远折叠不完的远行地图", type: "WANDERER" }
            ]}
        ];

        const Icon = ({ name, size = 24, className = "" }) => {
            const paths = {
                ChevronRight: "M9 18l6-6-6-6",
                RefreshCw: "M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15",
                Quote: "M3 21c3 0 7-1 7-8V5c0-1.25-.75-2-2-2H3c-1.25 0-2 .75-2 2v7c0 1.25.75 2 2 2 0 4-1 6-2 6zm11 0c3 0 7-1 7-8V5c0-1.25-.75-2-2-2h-5c-1.25 0-2 .75-2 2v7c0 1.25.75 2 2 2 0 4-1 6-2 6z",
                ArrowLeft: "M19 12H5M12 19l-7-7 7-7",
                ArrowRight: "M5 12h14M12 5l7 7-7 7",
                PenTool: "M12 19l7-7 3 3-7 7-3-3z M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z M2 2l5 5",
                ChevronDown: "M6 9l6 6 6-6",
                ChevronUp: "M18 15l-6-6-6 6",
                Star: "M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z",
                Bookmark: "M19 21l-7-5-7 5V5a2 2 0 012-2h10a2 2 0 012 2z",
                BookOpen: "M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z",
                Layers: "M12 2L2 7l10 5 10-5-10-5z M2 17l10 5 10-5 M2 12l10 5 10-5",
                Zap: "M13 2L3 14h9l-1 8 10-12h-9l1-8z",
                Download: "M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4 M7 10l5 5 5-5 M12 15V3",
                Fingerprint: "M12 11c0 3.517-1.009 6.799-2.753 9.571m-4.94-8.828A9 9 0 0118 9c0 1.258-.258 2.456-.725 3.546m-3.562 3.954A9 9 0 014 12"
            };
            return (
                <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    <path d={paths[name] || ""} />
                </svg>
            );
        };

        const JarIllustration = () => (
            <svg viewBox="0 0 400 350" className="w-full h-full drop-shadow-sm">
                <path d="M150 100 L250 100 L265 135 Q 310 160 310 250 Q 310 310 200 310 Q 90 310 90 250 Q 90 160 135 135 Z" fill="none" stroke={COLORS.textMain} strokeWidth="1.5" />
                <path d="M160 110 L240 110" stroke={COLORS.textMain} strokeWidth="1" />
                <g transform="translate(180, 210)">
                    <circle cx="20" cy="20" r="8" fill="none" stroke={COLORS.textMain} strokeWidth="1.2" />
                    <path d="M20 28 Q 20 55 10 75 M20 28 Q 20 55 30 75" fill="none" stroke={COLORS.textMain} strokeWidth="1.2" />
                    <path d="M12 45 Q 20 40 28 45" fill="none" stroke={COLORS.textMain} strokeWidth="1.2" />
                </g>
                <circle cx="330" cy="110" r="4" fill={COLORS.textMain} />
                <circle cx="350" cy="140" r="2" fill={COLORS.textMain} />
                <path d="M265 135 Q 360 70 390 110" stroke={COLORS.textMain} strokeWidth="0.6" strokeDasharray="5 3" />
                <g transform="translate(35, 45) rotate(-6)">
                    <rect x="0" y="0" width="85" height="32" rx="4" fill="white" stroke={COLORS.border} strokeWidth="1" />
                    <text x="42" y="21" textAnchor="middle" fontSize="9" fill={COLORS.textSecondary} style={{fontWeight: 'bold'}}>存稿编号：零壹</text>
                </g>
                <g transform="translate(285, 275) rotate(12)">
                    <path d="M0 20 Q 25 -5 55 20" fill="none" stroke={COLORS.accentBlue} strokeWidth="1.8" />
                    <text x="0" y="48" fontSize="8.5" fill={COLORS.accentBlue} style={{fontWeight: 'bold'}}>精神底色投射 →</text>
                </g>
                <circle cx="350" cy="55" r="28" fill={COLORS.accentYellow} opacity="0.35" />
                <rect x="45" y="245" width="45" height="45" rx="22" fill={COLORS.accentGreen} opacity="0.25" />
            </svg>
        );

        function App() {
            const [step, setStep] = useState('welcome');
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [scores, setScores] = useState({ REBEL: 0, SAGE: 0, IDEALIST: 0, WANDERER: 0, HERO: 0 });
            const [history, setHistory] = useState([]);
            const [result, setResult] = useState(null);
            const [isSaving, setIsSaving] = useState(false);
            const [code, setCode] = useState("");
            const [showError, setShowError] = useState(false);

            const radarCanvas = useRef(null);
            const captureRef = useRef(null);
            const chartRef = useRef(null);

            const handleVerify = () => { if (code.toLowerCase() === "cloud") setStep('quiz'); else { setShowError(true); setTimeout(() => setShowError(false), 500); } };
            const handleAnswer = (type) => {
                const newScores = { ...scores, [type]: scores[type] + 1 };
                setHistory([...history, { scores, currentQuestion }]);
                setScores(newScores);
                if (currentQuestion < 29) setCurrentQuestion(currentQuestion + 1);
                else {
                    const top = Object.keys(newScores).reduce((a, b) => newScores[a] > newScores[b] ? a : b);
                    setResult(ARCHETYPES[top]);
                    setStep('result');
                    window.scrollTo(0, 0);
                }
            };
            const handleBack = () => { if (history.length > 0) { const last = history.pop(); setScores(last.scores); setCurrentQuestion(last.currentQuestion); setHistory([...history]); } else setStep('welcome'); };
            const handleRestart = () => { setStep('welcome'); setCurrentQuestion(0); setScores({ REBEL: 0, SAGE: 0, IDEALIST: 0, WANDERER: 0, HERO: 0 }); setHistory([]); setResult(null); setCode(""); window.scrollTo(0, 0); };

            const saveAsImage = async () => {
                setIsSaving(true);
                try {
                    const canvas = await html2canvas(captureRef.current, { scale: 2, backgroundColor: COLORS.bg, useCORS: true });
                    const link = document.createElement('a');
                    link.download = `文学报告-${result.name}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                } catch (err) { console.error(err); }
                setIsSaving(false);
            };

            useEffect(() => {
                if (step === 'result' && result && radarCanvas.current) {
                    if (chartRef.current) chartRef.current.destroy();
                    chartRef.current = new Chart(radarCanvas.current.getContext('2d'), {
                        type: 'radar',
                        data: {
                            labels: ['反叛', '智性', '审美', '自由', '英雄性'],
                            datasets: [{ data: result.stats, backgroundColor: 'rgba(53, 175, 203, 0.1)', borderColor: COLORS.accentBlue, borderWidth: 1, pointRadius: 0 }]
                        },
                        options: { scales: { r: { angleLines: { display: false }, grid: { color: 'rgba(0,0,0,0.05)' }, ticks: { display: false }, min: 0, max: 100 } }, plugins: { legend: { display: false } } }
                    });
                }
            }, [step, result]);

            return (
                <div className="max-w-xl mx-auto px-4 py-8">
                    {step === 'welcome' && (
                        <div className="animate-fade-in text-center space-y-12">
                            <div className="text-left pt-6">
                                <div className="inline-block px-3 py-1 bg-[#35afcb] text-white text-[9px] tracking-widest mb-4 transform -rotate-2">Psychographic Assessment</div>
                                <h1 className="text-4xl md:text-5xl font-light leading-tight tracking-widest text-[#3a3833]">寻找你的<br /><span className="font-bold border-b-4 border-[#e8ed2a]">作家人格</span></h1>
                            </div>
                            <div className="w-full max-w-[340px] mx-auto aspect-[4/3.5] relative">
                                <JarIllustration />
                                <div className="absolute top-[20%] right-[-10px] bg-white px-3 py-2 rounded-2xl shadow-sm border border-[#dcd8cf] transform rotate-3 max-w-[120px]">
                                    <p className="text-[10px] text-[#6d6b64] leading-tight italic">“在叙事中，<br/>发明你自己”</p>
                                </div>
                            </div>
                            <div className="space-y-10">
                                <p className="text-xs text-[#6d6b64] leading-relaxed tracking-wider px-6 font-light">基于 30 组跨越时空的文学幻境，勾勒你灵魂深处的回响。</p>
                                <div className={`space-y-4 ${showError ? 'shake' : ''}`}>
                                    <div className="flex flex-col items-center gap-2">
                                        <span className="text-[10px] uppercase tracking-[0.3em] opacity-40">文学通行码认证</span>
                                        <input 
                                            type="text" 
                                            value={code} 
                                            onChange={(e) => setCode(e.target.value)} 
                                            className="redeem-input w-48 py-2 text-sm" 
                                            placeholder="请输入通行码" 
                                        />
                                        {showError && <span className="text-[9px] text-red-400">认证失败，请核对。</span>}
                                    </div>
                                </div>
                                <button onClick={handleVerify} className="w-full py-6 bg-[#3a3833] text-white text-[11px] tracking-[0.8em] font-bold flex items-center justify-center gap-4 active:scale-95 transition-all">开启漫游 / LAUNCH <Icon name="ArrowRight" size={16} className="text-[#e8ed2a]" /></button>
                                <div className="text-[10px] text-gray-400 tracking-[0.3em]">Curated by @云树cloudtree</div>
                            </div>
                        </div>
                    )}

                    {step === 'quiz' && (
                        <div className="animate-fade-in space-y-8 text-center">
                            <div className="flex justify-between items-center border-b border-[#dcd8cf] pb-4">
                                <button onClick={handleBack} className="flex items-center gap-1 text-[10px] uppercase opacity-40 hover:opacity-100 transition-all"><Icon name="ArrowLeft" size={14} /> BACK</button>
                                <span className="text-[9px] uppercase text-[#6d6b64] font-bold">Step {String(currentQuestion + 1).padStart(2, '0')} / 30</span>
                                <div className="w-10"></div>
                            </div>
                            <h2 className="text-xl md:text-2xl leading-relaxed min-h-[140px] flex items-center justify-center italic px-4">{QUESTIONS[currentQuestion].text}</h2>
                            <div className="space-y-4 text-left">
                                {QUESTIONS[currentQuestion].options.map((option, idx) => (
                                    <button key={idx} onClick={() => handleAnswer(option.type)} className="w-full p-6 bg-white bg-opacity-70 rounded-[12px] border border-[#dcd8cf] hover:border-[#3a3833] transition-all group flex items-center justify-between text-left">
                                        <span className="text-[14px] text-[#6d6b64] group-hover:text-[#3a3833] leading-relaxed pr-4">{option.text}</span>
                                        <Icon name="ChevronRight" size={14} className="opacity-0 group-hover:opacity-100 transition-all text-[#35afcb]" />
                                    </button>
                                ))}
                            </div>
                            <div className="pt-10 flex justify-center"><div className="h-[1px] w-48 bg-[#dcd8cf] relative"><div className="h-full bg-[#3a3833] transition-all duration-700" style={{width: `${((currentQuestion+1)/30)*100}%`}}></div></div></div>
                        </div>
                    )}

                    {step === 'result' && result && (
                        <div className="animate-fade-in space-y-8 pb-12">
                            <div ref={captureRef} className="p-4 space-y-12 bg-[#f2f0e9]">
                                <div className="text-center space-y-6 py-12 bg-white border border-[#dcd8cf] rounded-sm shadow-sm relative overflow-hidden">
                                    <div className="absolute top-4 left-4"><Icon name="Fingerprint" size={32} className="opacity-10" /></div>
                                    <span className="text-[10px] font-bold uppercase tracking-[0.5em] text-[#35afcb]">Literature Archetype Profile</span>
                                    {/* 核心改动：减小名字字体大小 text-5xl md:text-6xl -> text-4xl md:text-5xl */}
                                    <h2 className="text-4xl md:text-5xl font-bold text-[#3a3833] tracking-widest">{result.name}</h2>
                                    <p className="text-sm text-[#35afcb] italic tracking-[0.4em]">{result.sub}</p>
                                    <div className="flex justify-center gap-4 pt-4">
                                        <span className="px-3 py-1 border border-[#3a3833] text-[9px] font-bold uppercase">思辨觉醒度 98%</span>
                                        <span className="px-3 py-1 bg-[#3a3833] text-white text-[9px] font-bold uppercase">主体性存证</span>
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white p-8 border border-[#dcd8cf] relative">
                                    <div className="absolute -top-3 -right-3 px-3 py-1 bg-white border border-[#3a3833] text-[10px] font-bold transform rotate-3">NO. 2026-Soul</div>
                                    <div className="space-y-4 text-left">
                                        <h4 className="text-[11px] font-bold border-b pb-2">叙事基因分析报告</h4>
                                        <div className="space-y-3">
                                            <div className="flex justify-between items-center text-[10px]"><span>感性驱动</span><div className="w-24 h-1 bg-gray-100"><div className="h-full bg-[#e8ed2a]" style={{width:'85%'}}></div></div></div>
                                            <div className="flex justify-between items-center text-[10px]"><span>理性逻辑</span><div className="w-24 h-1 bg-gray-100"><div className="h-full bg-[#35afcb]" style={{width:'40%'}}></div></div></div>
                                            <div className="flex justify-between items-center text-[10px]"><span>反叛意志</span><div className="w-24 h-1 bg-gray-100"><div className="h-full bg-black" style={{width:'70%'}}></div></div></div>
                                        </div>
                                        <div className="handwritten-note mt-4 text-left">* 核心观察：存在强烈的审美自觉</div>
                                    </div>
                                    <div className="aspect-square w-full max-w-[200px] mx-auto">
                                        <canvas ref={radarCanvas}></canvas>
                                    </div>
                                </div>

                                <div className="relative p-12 bg-white border border-[#dcd8cf] text-center shadow-sm">
                                    <Icon name="Quote" size={32} className="text-[#35afcb] mb-6 opacity-20 mx-auto" />
                                    <p className="text-xl leading-relaxed mb-6 font-medium text-center">
                                        <span className="highlight-yellow">{result.quote}</span>
                                    </p>
                                    <div className="text-[10px] text-[#a4c29b] tracking-widest uppercase font-bold text-center">— {result.quoteSource} —</div>
                                </div>

                                <div className="space-y-10 px-2 text-left">
                                    <section className="space-y-4">
                                        <h4 className="text-[11px] font-bold uppercase tracking-[0.5em] flex items-center gap-3 border-b border-[#dcd8cf] pb-2">
                                            <Icon name="Layers" size={14} className="text-[#35afcb]" /> 灵魂本色 / THE SELF
                                        </h4>
                                        <div className="bg-white p-6 border-l-4 border-[#35afcb] space-y-4">
                                            <p className="text-[13px] leading-relaxed text-[#6d6b64] italic">“{result.identity}”</p>
                                            <p className="text-[13px] leading-relaxed font-light">{result.longDesc}</p>
                                        </div>
                                    </section>
                                    <section className="space-y-4 text-left">
                                        <h4 className="text-[11px] font-bold uppercase tracking-[0.5em] flex items-center gap-3 border-b border-[#dcd8cf] pb-2 text-red-800">
                                            <Icon name="Zap" size={14} className="text-red-600" /> 核心焦虑与盲区
                                        </h4>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-[12px]">
                                            <div className="p-4 bg-red-50 border border-red-100 rounded">
                                                <div className="font-bold mb-1">主导焦虑</div>
                                                <div className="opacity-70">{result.anxiety}</div>
                                            </div>
                                            <div className="p-4 bg-gray-50 border border-gray-100 rounded">
                                                <div className="font-bold mb-1">阴影面</div>
                                                <div className="opacity-70">{result.shadow}</div>
                                            </div>
                                        </div>
                                    </section>
                                    <section className="space-y-6 text-left">
                                        <h4 className="text-[11px] font-bold uppercase tracking-[0.5em] flex items-center gap-3 border-b border-[#dcd8cf] pb-2">
                                            <Icon name="Star" size={14} className="text-[#e8ed2a]" /> 进阶书单推荐
                                        </h4>
                                        <div className="grid gap-4">
                                            {result.books.map((book, i) => (
                                                <div key={i} className="bg-white p-6 border border-[#dcd8cf] relative group">
                                                    <div className="absolute top-0 right-0 p-2 opacity-5"><Icon name="Bookmark" size={20} /></div>
                                                    <h5 className="text-[15px] font-bold mb-1">{book.title}</h5>
                                                    <p className="text-[10px] text-[#a4c29b] font-bold mb-2">作者: {book.author}</p>
                                                    <p className="text-xs text-[#6d6b64] italic leading-relaxed opacity-80">{book.desc}</p>
                                                </div>
                                            ))}
                                        </div>
                                    </section>
                                </div>
                            </div>

                            <div className="pt-8 space-y-4 text-center px-4">
                                <button onClick={saveAsImage} disabled={isSaving} className="w-full py-5 bg-black text-white text-[11px] font-bold uppercase tracking-[0.5em] flex items-center justify-center gap-3 shadow-xl active:bg-gray-800 disabled:opacity-50">
                                    {isSaving ? "生成中..." : <><Icon name="Download" size={16} /> 保存手稿报告 / SAVE REPORT</>}
                                </button>
                                <button onClick={handleRestart} className="w-full py-5 border border-[#3a3833] text-[11px] font-bold uppercase tracking-[0.5em] hover:bg-[#3a3833] hover:text-white transition-all">
                                    <Icon name="RefreshCw" size={14} className="inline mr-2" /> 再次重塑原型
                                </button>
                            </div>
                        </div>
                    )}
                    <footer className="mt-16 pt-16 border-t border-[#dcd8cf] text-center space-y-4">
                        <p className="text-[10px] tracking-[0.6em] uppercase text-[#3a3833] font-bold opacity-60">© 2026 CURATED BY @云树CLOUDTREE</p>
                        <p className="text-[9px] tracking-[0.3em] uppercase text-[#6d6b64] opacity-30 italic">为精神生长提供坐标 / Mapping Mental Growth</p>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
