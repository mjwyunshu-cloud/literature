<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>文学原型测试 | 世界二十大家作家人格</title>
    
    <!-- 全球加速 CDN -->
    <script src="https://fastly.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://fastly.jsdelivr.net/npm/chart.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;500;700&display=swap" rel="stylesheet">

    <style>
        :root { --bg-color: #f2f0e9; --text-main: #3a3833; }
        body {
            font-family: 'Noto Serif SC', "PingFang SC", "Hiragino Sans GB", serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
            margin: 0;
        }
        .animate-fade-in { animation: fadeIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .highlight-yellow {
            background: linear-gradient(180deg, rgba(255,255,255,0) 50%, #e8ed2a 50%);
            padding: 0 4px;
        }

        .redeem-input {
            background: transparent;
            border: none;
            border-bottom: 1.5px solid #3a3833;
            outline: none;
            text-align: center;
            letter-spacing: 0.2em;
            transition: all 0.3s;
        }
        .redeem-input:focus { border-bottom: 2px solid #35afcb; }
        .shake { animation: shake 0.4s ease-in-out; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        
        ::-webkit-scrollbar { width: 0px; background: transparent; }
        #root:empty { background: #f2f0e9; height: 100vh; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const COLORS = { 
            bg: "#f2f0e9", textMain: "#3a3833", textSecondary: "#6d6b64", 
            accentYellow: "#e8ed2a", accentBlue: "#35afcb", accentGreen: "#a4c29b", border: "#dcd8cf" 
        };

        const ARCHETYPES = {
            KAFKA: { name: "弗朗茨·卡夫卡", sub: "异化世界的清醒者", identity: "你在荒谬的规则中进行无止尽的个人突围。", anxiety: "害怕被庞大的力量彻底异化。", shadow: "过度自我封闭可能陷入无法抵达目的地的焦虑。", stats: [98, 45, 70, 55, 80], quote: "即使变成甲虫，也要保持思考的尊严。", quoteSource: "《变形记》", longDesc: "你对生活中的‘理所当然’持有生理性的警惕。文学对你而言不是避风港，而是揭露真实荒诞性的手术刀。", books: [{title: "《审判》", author: "卡夫卡", desc: "在不可理喻的生存处境中面对指控。"}] },
            CAMUS: { name: "阿尔贝·加缪", sub: "荒诞中的反抗英雄", identity: "即使面对永恒推石上山的命运，也要宣告幸福。", anxiety: "害怕失去行动的意义而变得麻木。", shadow: "容易陷入局外人的困境。", stats: [92, 75, 55, 88, 85], quote: "在隆冬，我发现心里有一个不可战胜的夏天。", quoteSource: "《夏天集》", longDesc: "你承认世界的荒谬，但你拒绝以此为借口消极遁世。你是一个脚踩大地的理想主义者，通过创造和热爱来抗击虚无。", books: [{title: "《局外人》", author: "加缪", desc: "用冷峻的诚实抗击世界的荒谬。"}] },
            PLATH: { name: "西尔维娅·普拉斯", sub: "真实底色的追光者", identity: "赤裸地面对灵魂最深处的风暴与真相。", anxiety: "害怕被琐碎的生活和陈旧角色窒息。", shadow: "过于激烈的真诚可能导致灼烧。", stats: [95, 55, 80, 45, 92], quote: "我从灰烬中升起，我以人类为食。", quoteSource: "《爱丽儿》", longDesc: "你具有极致的激烈与真实。你拒绝任何精神妥协。你的文字承载了对自由最赤裸的渴望。", books: [{title: "《钟形罩》", author: "普拉斯", desc: "在窒息中寻找自我的杰作。"}] },
            SAGAN: { name: "弗朗索瓦丝·萨冈", sub: "忧愁的叛逆少年", identity: "用慵懒轻灵的姿态抗拒传统的沉重。", anxiety: "害怕激情过后的空虚与无意义。", shadow: "随性可能演变为某种任性。", stats: [88, 55, 85, 90, 60], quote: "所有这些温柔忧伤的时刻。", quoteSource: "《你好，忧愁》", longDesc: "你代表了青春的叛逆与敏感。你用一种漫不经心的优雅撕开了成人世界的伪善。", books: [{title: "《某种微笑》", author: "萨冈", desc: "青春的任性与幻灭。"}] },
            BORGES: { name: "豪尔赫·博尔赫斯", sub: "逻辑迷宫的筑造者", identity: "你视世界为一座由符号、典籍和无限分岔构成的图书馆。", anxiety: "害怕叙事逻辑的坍塌与混沌。", shadow: "容易陷入极度的智性傲慢。", stats: [45, 98, 35, 80, 60], quote: "天堂应该是图书馆的模样。", quoteSource: "《关于天赐之诗》", longDesc: "你迷恋精密的结构、镜子与迷宫，看透本质带来的超脱感是你的核心驱动力。", books: [{title: "《虚构集》", author: "博尔赫斯", desc: "彻底打破现实与幻想的边界。"}] },
            JOYCE: { name: "詹姆斯·乔伊斯", sub: "语言迷宫的开拓者", identity: "用极致复杂的符号重构平凡的一天。", anxiety: "害怕平庸叙事对真相的遮蔽。", shadow: "过度追求语言实验。", stats: [50, 98, 92, 60, 75], quote: "错误是发现的门径。", quoteSource: "《尤利西斯》", longDesc: "你认为真相隐藏在日常的每一个细枝末节中。你通过解构语言来重建现实。", books: [{title: "《都柏林人》", author: "乔伊斯", desc: "剖析平庸生活背后的灵魂瘫痪。"}] },
            BEAUVOIR: { name: "西蒙娜·德·波伏娃", sub: "主体性的先行者", identity: "拒绝预设角色，在选择中创造自我。", anxiety: "害怕被他人的眼光或社会的定义所物化。", shadow: "极度的理性有时会显得冷酷。", stats: [90, 88, 50, 80, 75], quote: "我绝不让我的生命受任何人的支配。", quoteSource: "《第二性》", longDesc: "你认为自由是责任。文学是你解构权力、声明存在的旗帜。", books: [{title: "《名士风流》", author: "波伏娃", desc: "探讨知识分子的责任与自由。"}] },
            CHRISTIE: { name: "阿加莎·克里斯蒂", sub: "人性迷雾的解谜者", identity: "在秩序的崩坏中寻找逻辑的终点。", anxiety: "害怕邪恶无法被理性归位。", shadow: "缺失对苦难的共情。", stats: [35, 98, 40, 65, 80], quote: "事实总是能说明一切。", quoteSource: "《波洛探案集》", longDesc: "你相信真相只有一个。你在混乱的表象下寻找必然的线索，你是秩序的守护者。", books: [{title: "《无人生还》", author: "阿加莎", desc: "关于罪与罚的终极智力博弈。"}] },
            WILDE: { name: "奥斯卡·王尔德", sub: "唯美主义的殉道者", identity: "艺术高于生活，精致高于教化。", anxiety: "害怕平庸与审美贫瘠。", shadow: "可能导致内心的脆弱感。", stats: [80, 65, 98, 50, 70], quote: "只有浅薄的人才不以貌取人。", quoteSource: "《画像》", longDesc: "你坚信‘美’是唯一的信仰。你通过极致的审美来对抗乏味的世界。", books: [{title: "《深渊书简》", author: "王尔德", desc: "在黑暗中写就的关于美的反思。"}] },
            PROUST: { name: "马塞尔·普鲁斯特", sub: "时间的拾荒者", identity: "通过感官的共振召唤失落的过去。", anxiety: "害怕时光流逝带走生命的意义。", shadow: "沉溺于过去，容易疲惫。", stats: [30, 95, 95, 55, 60], quote: "真正的发现之旅，在于拥有新眼光。", quoteSource: "《追寻逝去的时光》", longDesc: "你是细节的狂信徒。你认为时间只有被文学化之后才有意义。", books: [{title: "《在少女花影下》", author: "普鲁斯特", desc: "在细腻的记忆折痕中寻找永恒。"}] },
            WOOLF: { name: "弗吉尼亚·伍尔夫", sub: "内在意识的流浪诗人", identity: "捕捉转瞬即逝的颤动，在时间的切片中寻找神性。", anxiety: "害怕灵魂的敏感被生活琐碎玷污。", shadow: "由于无法在现实落脚而走向脆弱。", stats: [35, 60, 98, 45, 85], quote: "不必行色匆匆，只需做你自己。", quoteSource: "《自己的房间》", longDesc: "你具有捕捉瞬间神性的天赋。你坚信‘美即是真’，文学是你重构精神空间的诺亚方舟。", books: [{title: "《到灯塔去》", author: "伍尔夫", desc: "完成一场对永恒的试探。"}] },
            DICKINSON: { name: "艾米莉·狄金森", sub: "内心宇宙的隐秘女皇", identity: "在极小物理空间构建无限精神国度。", anxiety: "害怕精神的喧嚣和外部的闯入。", shadow: "过度的精神洁癖导致断裂。", stats: [30, 92, 90, 35, 65], quote: "假如我不曾见过太阳，我本可以忍受黑暗。", quoteSource: "《诗集》", longDesc: "你是精神的独居者，在页边距里建立国家。你灵魂的深度足以让你在方寸之间俯瞰宇宙。", books: [{title: "《孤独是迷人的》", author: "狄金森", desc: "极致凝练的文字通向灵魂深处。"}] },
            HESSE: { name: "赫尔曼·黑塞", sub: "灵魂深处的漫游者", identity: "身份在不断的行走与修行中被‘发明’。", anxiety: "害怕任何形式的定居与安稳。", shadow: "缺乏深度的世俗联结。", stats: [60, 50, 75, 98, 50], quote: "我只是一个探索者，一个流浪者。", quoteSource: "《德米安》", longDesc: "你对应着苦行与漫游。你不在乎目的地，你在乎的是自我的完整。", books: [{title: "《荒原狼》", author: "黑塞", desc: "在人性的挣扎中寻找灵魂平衡点。"}] },
            MURAKAMI: { name: "村上春树", sub: "都市孤独的守望者", identity: "在日常裂缝中寻找另一个世界的入口。", anxiety: "害怕与真实自我的永久失联。", shadow: "过度的疏离感。", stats: [55, 75, 85, 92, 60], quote: "感受才是正确的。", quoteSource: "《挪威的森林》", longDesc: "你在都市的喧嚣中保持着独特的静默。你通过某种隐秘的仪式感潜入深井，修补那破碎的现实。", books: [{title: "《奇鸟行状录》", author: "村上春树", desc: "通过潜入深井来修补现实。"}] },
            MORRISON: { name: "托尼·莫里森", sub: "记忆与创伤的疗愈者", identity: "在破碎的叙事中重塑族群的灵魂。", anxiety: "害怕历史的沉默与自我的丧失。", shadow: "叙事过于紧绷。", stats: [75, 80, 85, 88, 92], quote: "如果你想飞，你必须放下拖累你的东西。", quoteSource: "《所罗门之歌》", longDesc: "你不仅是在写作，你是在修复一种文明的裂痕。你的文字充满了原始的力量感。", books: [{title: "《宠儿》", author: "莫里森", desc: "关于创伤、母爱与生存的史诗。"}] },
            ATWOOD: { name: "玛格丽特·阿特伍德", sub: "末世寓言的观察家", identity: "在生存的边缘预演文明的坍塌。", anxiety: "害怕女性主体性的彻底丧失。", shadow: "冷峻的预言视角有时让人绝望。", stats: [85, 90, 70, 80, 85], quote: "眼光必须清醒，即使看到的只有灰烬。", quoteSource: "《使女的故事》", longDesc: "你是极其清醒的观察者。你在层层包裹的虚构中揭开真实。", books: [{title: "《盲刺客》", author: "阿特伍德", desc: "在层层包裹的虚构中揭开真相。"}] },
            HEMINGWAY: { name: "欧内斯特·海明威", sub: "重压下的尊严硬汉", identity: "在必败的战争中确立人的尊严。", anxiety: "害怕意志的枯竭与怯懦。", shadow: "容易被壮烈感绑架。", stats: [85, 70, 45, 55, 98], quote: "一个人可以被毁灭，但不能被击败。", quoteSource: "《老人与海》", longDesc: "你理解世界的残酷，但选择穿上最重的铠甲。文学对你而言是祭坛。", books: [{title: "《太阳照常升起》", author: "海明威", desc: "在迷惘时代寻找行动的意义。"}] },
            MARQUEZ: { name: "加西亚·马尔克斯", sub: "魔幻现实的编织者", identity: "在神话与现实的交界处观察兴衰。", anxiety: "害怕孤独的轮回与历史的遗忘。", shadow: "宏大视野忽视微观。", stats: [70, 85, 80, 75, 90], quote: "生命中重要的是你记住了什么。", quoteSource: "《百年孤独》", longDesc: "你擅长将魔幻与写实无缝融合。你认为人类的历史是一场注定的轮回。", books: [{title: "《霍乱时期的爱情》", author: "马尔克斯", desc: "跨越半个世纪的意志与深情。"}] },
            DURAS: { name: "玛格丽特·杜拉斯", sub: "欲望与痛苦的叙事者", identity: "将痛苦提炼为美，在绝望中寻找光。", anxiety: "害怕狂热的欲望被平庸埋没。", shadow: "极度的沉溺感导致病态。", stats: [75, 40, 92, 60, 80], quote: "我准备好为你毁灭。", quoteSource: "《情人》", longDesc: "你是欲望的诗人。你在夕阳里见证了毁坏的快感。你让痛苦成为勋章。", books: [{title: "《广岛之恋》", author: "杜拉斯", desc: "关于遗忘、爱情与战争的极致叙事。"}] },
            EILEEN_CHANG: { name: "张爱玲", sub: "荒凉美学的洞察者", identity: "在华丽的袍子上观察虱子。", anxiety: "害怕在时间的荒野里被抛弃。", shadow: "透彻的苍凉感使人生显得虚无。", stats: [40, 88, 95, 50, 65], quote: "生命是一袭华丽的袍，爬满了蚤子。", quoteSource: "《天才梦》", longDesc: "你在华丽中看到了腐朽，在日常中看到了命运。你记录了旧时代的挽歌。", books: [{title: "《半生缘》", author: "张爱玲", desc: "时间的无情与命运的错身。"}] }
        };

        const QUESTIONS = [
            { id: 1, text: "在卡夫卡的《法门前》，如果你是那位等了一辈子的乡下人，临死前你会：", options: [{ text: "对着守门人发出一声狂笑，意识到那扇门从未存在过", type: "REBEL" }, { text: "起身离开，在旷野中寻找属于自己的出口，哪怕毫无意义", type: "WANDERER" }, { text: "最后一次分析守门人的台词，试图推演这套系统的逻辑漏洞", type: "SAGE" }, { text: "为这一生的徒劳，在脑海里补足一个唯美且神圣的结局", type: "IDEALIST" }] },
            { id: 2, text: "进入博尔赫斯的无限图书馆，如果在这个宇宙终结前你只能带走一本书：", options: [{ text: "那本包含所有答案、却也包含所有谎言的“总目录”", type: "SAGE" }, { text: "撕碎所有的索引，带走一页从未被任何眼光读过的残诗", type: "REBEL" }, { text: "一通向不同时空的、永无止境的航海日志", type: "WANDERER" }, { text: "记载着一段失落文明情史、美得虚幻且不切实际的画本", type: "IDEALIST" }] },
            { id: 3, text: "海明威的圣地亚哥正面对夺走马林鱼的鲨鱼群，如果你是那支鱼叉：", options: [{ text: "握紧带有锈迹的柄，刺出那必败、但确立了生命尊严的一击", type: "HERO" }, { text: "冷静地折射出月光，将这一幕惨剧记录为自然的必然法则", type: "SAGE" }, { text: "挣脱束缚，任由自己沉入深海，拒绝参与这场博弈", type: "WANDERER" }, { text: "在血腥的海水中幻化成马林鱼跃出水面时的神性瞬间", type: "IDEALIST" }] },
            { id: 4, text: "在村上春树的深夜，你发现自家井底有一个通往潜意识的秘密通道：", options: [{ text: "点燃一根烟，在极致的孤独中潜入那座时间的迷宫", type: "WANDERER" }, { text: "随手关上井盖：平庸的生活，才是人类最坚固的屏障", type: "HERO" }, { text: "不管对面是什么，都要用这口枯井作为反抗现实的秘密据点", type: "REBEL" }, { text: "认定那是灵魂失散已久的故乡，义无反顾地跃入", type: "IDEALIST" }] },
            
            // --- 重构的深度叙事题目 (5-30) ---
            { id: 5, text: "在张爱玲式的月光阳台上，晚风带着陈旧的烟味。你失手打碎了一件精致的古董，那曾是家族最引以为傲的荣耀：", options: [
                { text: "冷眼看着那一地碎片：在时间的荒野里，华丽的崩塌也是种艺术", type: "HERO" },
                { text: "直接将剩余也打碎：我不受任何陈腐旧梦的统治与支配", type: "REBEL" },
                { text: "研究碎片飞溅的轨迹，寻找这一偶然背后潜藏的因果必然", type: "SAGE" },
                { text: "拍拍手上的灰尘，头也不回走开：旧物只是漫长旅途中的一个路标", type: "WANDERER" }
            ]},
            { id: 6, text: "波伏娃邀你在左岸咖啡馆谈论主体性。当被问及“什么是自由”时，你的回答是：", options: [
                { text: "“自由是我在逻辑迷宫中，唯一能够逃逸出预设系统的非逻辑出口”", type: "SAGE" },
                { text: "“自由是在剥离掉所有社会定义、家庭角色后的那个‘真实血肉’”", type: "REBEL" },
                { text: "“自由是意识到虚无后，依然选择推石上山的英雄风度”", type: "HERO" },
                { text: "“自由是精神本质的彻底纯化，它只存在于感官的瞬时震颤中”", type: "IDEALIST" }
            ]},
            { id: 7, text: "阿加莎的东方快车发生命案，所有人都在伪装。当你作为侦探步入车厢时，你最先察觉到的是：", options: [
                { text: "每个人微表情间的逻辑错位，你享受那种将拼图闭环的智性快感", type: "SAGE" },
                { text: "这场罪行背后的社会宿命感，这不只是谋杀，而是时代的共谋", type: "HERO" },
                { text: "规则本身就是一场巨大的骗局，法律并不比谋杀更神圣", type: "REBEL" },
                { text: "窗外寂静雪原中那种带有死亡气息的、极致而残酷的美感", type: "IDEALIST" }
            ]},
            { id: 8, text: "王尔德要为你画那幅能代你衰老的画像。面对这个充满毒性的邀约，你会要求：", options: [
                { text: "画出极致的唯美，哪怕真实灵魂早已腐朽，我也要那层华丽皮囊", type: "IDEALIST" },
                { text: "画出最赤裸的丑陋，我要用这面镜子来审判这个伪善的世界", type: "REBEL" },
                { text: "画出意志的褶皱，展现人类对时光流逝那场必败、但尊严的抗争", type: "HERO" },
                { text: "拒绝画像，这种感性的交换毫无逻辑，我只相信观测到的实验数据", type: "SAGE" }
            ]},
            { id: 9, text: "狄金森带你在果园里观察一场罕见的日落。她指着那一抹血色余晖说：", options: [
                { text: "“这是上帝进行的一次唯美实验，也是我内心宇宙唯一的太阳”", type: "IDEALIST" },
                { text: "“光影反射的物理必然，秩序之美在于它从不因人的意志而偏移”", type: "SAGE" },
                { text: "“那是黑暗降临前最后的咆哮，真正的尊严在于绝不向黑夜妥协”", type: "HERO" },
                { text: "“那是通向另一个维度的门，灵魂应当随时准备好跃向更深处的旷野”", type: "WANDERER" }
            ]},
            { id: 10, text: "面对西绪福斯推上山的巨石，如果你是你笔下的叙述者，你会写道：", options: [
                { text: "“他转过身对着众神嘲笑：只要我意识到这种荒谬，我就已经超越了众神”", type: "REBEL" },
                { text: "“在巨石必然滚落前，他将自己的意志刻在了山顶，那是他活过的存证”", type: "HERO" },
                { text: "“计算巨石下落的曲率比推它上山更有意义，规律中藏着真正的超脱”", type: "SAGE" },
                { text: "“在山脚种一朵小花吧，美化这永恒的苦役是灵魂唯一的避难所”", type: "IDEALIST" }
            ]},
            { id: 11, text: "普鲁斯特的一块玛德琳蛋糕勾起了你排山倒海的记忆。你此时的第一冲动是：", options: [
                { text: "沉溺于这些感官碎片，在时间的折痕里构建一个永恒且自洽的午后", type: "IDEALIST" },
                { text: "冷眼旁观这些必然重复的宿命线，观察记忆是如何被逻辑二次加密的", type: "SAGE" },
                { text: "意识到‘过去’是个牢笼，我必须通过行走来清洗掉这些沉重的记忆", type: "WANDERER" },
                { text: "将这些记忆提炼为反抗平庸现实的子弹，射向那个令我窒息的当下", type: "REBEL" }
            ]},
            { id: 12, text: "黑塞的“魔幻剧场”门口写着：仅供疯子进入。你笑了一下，因为你深知：", options: [
                { text: "所谓‘正常人’的灵魂只是死水，只有在极致的孤独中才能发明自我", type: "WANDERER" },
                { text: "去观看灵魂内部那场唯美且带有毁灭色彩的潮汐，哪怕会因此陨落", type: "IDEALIST" },
                { text: "这剧场一定有一套秘密的准入算法，我必须通过反向解密进入核心", type: "SAGE" },
                { text: "撕掉那块告示：没有人有权定义谁是疯子，我要建立我自己的规则", type: "REBEL" }
            ]},
            { id: 13, text: "如果你被关进普拉斯笔下的《钟形罩》，在一个绝对透明且压抑的空间里，你会：", options: [
                { text: "敲碎玻璃，哪怕满手鲜血也要触碰外面的阳光，拒绝被定义的纯洁", type: "REBEL" },
                { text: "在罩壁上记录下每一道裂痕，将这绝望过程转化为某种文明的存证", type: "SAGE" },
                { text: "在脑内建立一个华丽的乌托邦，在这里，我永远不再是一个被叙述的人", type: "IDEALIST" },
                { text: "坦然穿上最沉重的甲胄，向那个必将到来的毁灭结局优雅地致敬", type: "HERO" }
            ]},
            { id: 14, text: "萨冈驾着跑车在南法公路上疾驰。当风速快到连思考都无法停留时，你感到了：", options: [
                { text: "极致的速度是抗衡庸俗生活唯一的良药，唯有破坏后的余温是真实的", type: "REBEL" },
                { text: "风的声音是自我发明的序曲，身份在不断的漂泊中终于获得了完整", type: "WANDERER" },
                { text: "计算风阻与摩擦力的平衡点，寻找这种疯狂行为背后的心理补偿机制", type: "SAGE" },
                { text: "夕阳下的公路美得让人心碎，忧伤是灵魂最昂贵的勋章", type: "IDEALIST" }
            ]},
            { id: 15, text: "在《地狱一季》入口，恶魔要你用“一半灵魂”交换文学魔力。你的回击是：", options: [
                { text: "即使灵魂沉沦，也要换取那一瞬间审美爆发的极致火光", type: "IDEALIST" },
                { text: "由于这种生理性的异化感到了极度的羞辱，拔剑发起必败的挑战", type: "HERO" },
                { text: "在停摆前走完最后一段路，即便没有灵魂，自由的意志也永恒存在", type: "WANDERER" },
                { text: "与其交易，通过契约底层的逻辑漏洞，反过来获取那整片地狱的叙事权", type: "SAGE" }
            ]},
            { id: 16, text: "乔伊斯的都柏林正在举行一场沉默的葬礼。你漫步在街道上，察觉到：", options: [
                { text: "复杂的语言符号构建了这一刻的神圣性，细节中藏着不朽的微光", type: "SAGE" },
                { text: "死亡只是另一种形式的远行，这些静止的仪式感让我感到生理性厌倦", type: "WANDERER" },
                { text: "必须打破这种瘫痪式的社会循环，即便是用一种暴力而荒诞的语调", type: "REBEL" },
                { text: "死者的脸庞在夕阳下有一种庄严而古老的美，这是唯一的救赎", type: "IDEALIST" }
            ]},
            { id: 17, text: "如果历史即将坍缩到只剩下一个词，你希望在废墟上留下的是：", options: [
                { text: "“但是”：永远保留那个转折、反抗与不服从的可能性", type: "REBEL" },
                { text: "“因为”：即便世界毁灭，也要守住因果律与逻辑的最后底线", type: "SAGE" },
                { text: "“也许”：为那个冰冷而确定的世界，保留最后一点朦胧的审美余地", type: "IDEALIST" },
                { text: "“再会”：预示着在另一个不可知的地平线上，我们终将再次启程", type: "WANDERER" }
            ]},
            { id: 18, text: "如果你能嗅到文字的气味，那读完你的核心叙事后，空气中应当弥漫着：", options: [
                { text: "福尔马林：一种冷静、洁净且带有某种智性解剖质感的气味", type: "SAGE" },
                { text: "火药与焦土：粗砺且带有破坏旧秩序后所留下的、炽热的余温", type: "REBEL" },
                { text: "旧报纸与风干的丁香：怀旧、敏感且带有一丝脆弱感的诗意", type: "IDEALIST" },
                { text: "咸涩的海风：广阔、野性且带着孤独的自由冲击", type: "WANDERER" }
            ]},
            { id: 19, text: "莫里森笔下的创伤正在隐隐作痛。面对那些被抹去的历史，你选择：", options: [
                { text: "在破碎的叙事中找回那个失落的名字，以此博回个体的尊严", type: "HERO" },
                { text: "意识到地平线上的自由比历史更有意义，我选择背负着伤痕远行", type: "WANDERER" },
                { text: "将这些痛苦解构为社会学的符号，看透它们如何被权力和话语操纵", type: "SAGE" },
                { text: "在泪水中消解苦难，将血迹化为辞藻，让残酷升华为一种哀悼的美学", type: "IDEALIST" }
            ]},
            { id: 20, text: "阿特伍德预言文明即将坍塌成一片灰烬。你站在边缘，内心感到的却是：", options: [
                { text: "记录下每一个逻辑错误，以此作为给后世文明的一份安全审计报告", type: "SAGE" },
                { text: "大笑这荒唐的剧终终于到来，废墟中才能开出真正野性的花", type: "REBEL" },
                { text: "隐入荒野寻找绿洲，身份的消失是我在这场末世中最自由的瞬间", type: "WANDERER" },
                { text: "即便面对死寂，也要守住人类最后的尊严与风度，体面地向结局敬酒", type: "HERO" }
            ]},
            { id: 21, text: "文学里的“风景”对你而言，最好的存在状态应当是：", options: [
                { text: "长满荆棘的角斗场，是试炼英雄主体性最绝佳的场所", type: "HERO" },
                { text: "几何形状的森林，每个树影都藏着指向宇宙真理的逻辑线索", type: "SAGE" },
                { text: "江南烟雨中的避难所，审美是我对抗异化现实唯一的诺亚方舟", type: "IDEALIST" },
                { text: "翻滚的大海或流动的沙漠，不断呼唤着漂泊者去认领他的孤独", type: "WANDERER" }
            ]},
            { id: 22, text: "叙事中出现了一段长达三页的沉默。你认为这段留白的质感应当是：", options: [
                { text: "一段加密的电报，等待着理性的解码，它暗示了某种隐秘的因果", type: "SAGE" },
                { text: "英雄最后的悲歌，在那无法言说的压抑下，主体的尊严达到了巅峰", type: "HERO" },
                { text: "猛烈反叛前的伏笔，这沉默本身就是对体制最无声且决绝的抗争", type: "REBEL" },
                { text: "语言无法承载的感性溢出，那是感官在面对神性瞬间时的生理性失语", type: "IDEALIST" }
            ]},
            { id: 23, text: "你在手稿的页边距里发现了一个“微型国家”，住着被你删掉的角色。你认为：", options: [
                { text: "这是叙事之外的非法寄生，应当被正文的严密逻辑彻底肃清", type: "REBEL" },
                { text: "这是主体性的一块自留地，是抗衡宏大叙事的、神圣的堡垒", type: "HERO" },
                { text: "这是语言系统的一种偶然溢出，体现了文本的不稳定性与迷宫属性", type: "SAGE" },
                { text: "这是我一直寻找的乌托邦，在这里我终于不再是一个被叙述的人", type: "IDEALIST" }
            ]},
            { id: 24, text: "“神秘主义”在你笔下的地位，通常呈现为：", options: [
                { text: "感性审美的温床，解释清楚了，美也就凋谢了", type: "IDEALIST" },
                { text: "理性的边疆，总有一天这些迷雾会被逻辑的光柱所穿透", type: "SAGE" },
                { text: "真理的掩体，我们要用不断的怀疑与反叛将真相从中逼出来", type: "REBEL" },
                { text: "永远追逐的地平线，它诱惑着我走向更遥远、更未知的时空", type: "WANDERER" }
            ]},
            { id: 25, text: "当你的对手是你亲手创造的一个角色时，你最希望：", options: [
                { text: "他拥有比我更坚定的反抗精神，甚至能从文本里跳出来反过来审判我", type: "REBEL" },
                { text: "他成为我智性的镜像，在逻辑的巅峰与我进行一场永无止境的博弈", type: "SAGE" },
                { text: "他成为我理想人格的载体，替我在充满尘埃的文字里完成纯洁的救赎", type: "IDEALIST" },
                { text: "他在必然的陨落中映照出人类主体性的尊严，即便我会输给他", type: "HERO" }
            ]},
            { id: 26, text: "海明威式的“流动的盛宴”已至深夜。当你步入巴黎微凉的街道，意识到这一场叙事已无法回头：", options: [
                { text: "头也不回地走向塞纳河对岸，远方才是灵魂唯一的自救之路", type: "WANDERER" },
                { text: "在路灯下完成最后的主体性辩护，那是作为人的最后风度", type: "HERO" },
                { text: "将这一晚所有的切片记录在案，汇成一本人类行为的冷酷百科", type: "SAGE" },
                { text: "在长椅上写下一首绝笔情诗，让这种陨落的痛苦升华为审美上的永恒", type: "IDEALIST" }
            ]},
            { id: 27, text: "面对神灵震耳欲聋的沉默，你笔下的主角给出的回答是：", options: [
                { text: "拔出那柄锈蚀的长剑，向那片虚无发起必败、但确立尊严的挑战", type: "HERO" },
                { text: "意识到神灵不过是人类逻辑极其苍白的投射，发出一声讥笑", type: "REBEL" },
                { text: "转身步入无尽的沙漠，在那神灵触及不到的沙丘中漫游", type: "WANDERER" },
                { text: "缓缓闭上双眼，用华丽且最高贵的幻觉去填补神灵留下的空位", type: "IDEALIST" }
            ]},
            { id: 28, text: "如果文字最终的形态应当被具象化，你希望它是一件：", options: [
                { text: "一把火炬：点燃读者的同时也毁灭自己，光亮本身就是反抗", type: "REBEL" },
                { text: "一个完美的圆环：首尾相接，因果环合，逻辑自闭且神圣", type: "SAGE" },
                { text: "一条延伸至地平线尽头的模糊直线，永远指向未知的下一页", type: "WANDERER" },
                { text: "一片散落在虚空中的、发光的羽毛，捕捉风的颤动并与之共存", type: "IDEALIST" }
            ]},
            { id: 29, text: "如果时间是纸张，你会在上面涂抹何种痕迹？", options: [
                { text: "无数个向后连接的箭头，编织一张庞大而精密的因果网", type: "SAGE" },
                { text: "一道道深邃、甚至见骨的划痕，记录下人类对抗宿命的最后伤疤", type: "HERO" },
                { text: "潦草、随性且漫无目的的曲线，让它们随风飘向未知的空白处", type: "WANDERER" },
                { text: "一层又一层半透明的彩墨，构建出一种虚幻且优雅的层叠感", type: "IDEALIST" }
            ]},
            { id: 30, text: "最后，如果你灵魂是一件文学圣器，那应当是：", options: [
                { text: "一把能剖开一切伪善与假面、滴着牺牲之血的利刃", type: "REBEL" },
                { text: "一架能观测星体运行轨迹、捕捉宇宙逻辑本质的望远镜", type: "SAGE" },
                { text: "一个能装下整片晚霞、让所有的痛苦都在词藻中干涸的墨水瓶", type: "IDEALIST" },
                { text: "一张永远折叠不完、通向不可知地平线的灵魂地图", type: "WANDERER" }
            ]}
        ];

        const JarIllustration = () => (
            <svg viewBox="0 0 400 350" className="w-full h-full drop-shadow-sm">
                <path d="M150 100 L250 100 L265 135 Q 310 160 310 250 Q 310 310 200 310 Q 90 310 90 250 Q 90 160 135 135 Z" fill="none" stroke={COLORS.textMain} strokeWidth="1.5" />
                <path d="M160 110 L240 110" stroke={COLORS.textMain} strokeWidth="1" />
                <g transform="translate(180, 210)">
                    <circle cx="20" cy="20" r="8" fill="none" stroke={COLORS.textMain} strokeWidth="1.2" />
                    <path d="M20 28 Q 20 55 10 75 M20 28 Q 20 55 30 75" fill="none" stroke={COLORS.textMain} strokeWidth="1.2" />
                    <path d="M12 45 Q 20 40 28 45" fill="none" stroke={COLORS.textMain} strokeWidth="1.2" />
                </g>
                <circle cx="330" cy="110" r="4" fill={COLORS.textMain} />
                <circle cx="350" cy="140" r="2" fill={COLORS.textMain} />
                <path d="M265 135 Q 360 70 390 110" stroke={COLORS.textMain} strokeWidth="0.6" strokeDasharray="5 3" />
                <g transform="translate(35, 45) rotate(-6)">
                    <rect x="0" y="0" width="85" height="32" rx="4" fill="white" stroke={COLORS.border} strokeWidth="1" />
                    <text x="42" y="21" textAnchor="middle" fontSize="9" fill={COLORS.textSecondary} fontWeight="bold">存稿编号：零壹</text>
                </g>
                <g transform="translate(285, 275) rotate(12)">
                    <path d="M0 20 Q 25 -5 55 20" fill="none" stroke={COLORS.accentBlue} strokeWidth="1.8" />
                    <text x="0" y="48" fontSize="8.5" fill={COLORS.accentBlue} fontWeight="bold">精神底色投射 →</text>
                </g>
                <circle cx="350" cy="55" r="28" fill={COLORS.accentYellow} opacity="0.35" />
                <rect x="45" y="245" width="45" height="45" rx="22" fill={COLORS.accentGreen} opacity="0.25" />
            </svg>
        );

        function App() {
            const [step, setStep] = useState('welcome');
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [scores, setScores] = useState({ REBEL: 0, SAGE: 0, IDEALIST: 0, WANDERER: 0, HERO: 0 });
            const [history, setHistory] = useState([]);
            const [result, setResult] = useState(null);
            const [isSaving, setIsSaving] = useState(false);
            const [code, setCode] = useState("");
            const [showError, setShowError] = useState(false);

            const radarCanvas = useRef(null);
            const captureRef = useRef(null);
            const chartRef = useRef(null);

            const handleVerify = () => { if (code.toLowerCase().trim() === "cloud") setStep('quiz'); else { setShowError(true); setTimeout(() => setShowError(false), 500); } };
            
            const handleAnswer = (type) => {
                const newScores = { ...scores, [type]: scores[type] + 1 };
                setHistory([...history, { scores, currentQuestion }]);
                setScores(newScores);
                if (currentQuestion < 29) {
                    setCurrentQuestion(currentQuestion + 1);
                } else {
                    const topArchetype = Object.keys(newScores).reduce((a, b) => newScores[a] > newScores[b] ? a : b);
                    const MAP = {
                        REBEL: ["KAFKA", "CAMUS", "PLATH", "SAGAN"],
                        SAGE: ["BORGES", "JOYCE", "BEAUVOIR", "CHRISTIE"],
                        IDEALIST: ["WOOLF", "DICKINSON", "WILDE", "PROUST"],
                        WANDERER: ["HESSE", "MURAKAMI", "MORRISON", "ATWOOD"],
                        HERO: ["HEMINGWAY", "MARQUEZ", "DURAS", "EILEEN_CHANG"]
                    };
                    const pool = MAP[topArchetype] || ["KAFKA"];
                    const key = pool[Math.floor(Math.random() * pool.length)];
                    setResult(ARCHETYPES[key]);
                    setStep('result');
                    window.scrollTo(0, 0);
                }
            };

            const handleBack = () => { 
                if (history.length > 0) { 
                    const newHistory = [...history];
                    const last = newHistory.pop(); 
                    setScores(last.scores); 
                    setCurrentQuestion(last.currentQuestion); 
                    setHistory(newHistory); 
                } else setStep('welcome'); 
            };

            const handleRestart = () => { 
                if (chartRef.current) { chartRef.current.destroy(); chartRef.current = null; }
                setStep('welcome'); setCurrentQuestion(0); setScores({ REBEL: 0, SAGE: 0, IDEALIST: 0, WANDERER: 0, HERO: 0 }); setHistory([]); setResult(null); setCode(""); setShowError(false); window.scrollTo(0, 0); 
            };

            useEffect(() => {
                if (step === 'result' && result && radarCanvas.current) {
                    if (chartRef.current) chartRef.current.destroy();
                    const ctx = radarCanvas.current.getContext('2d');
                    chartRef.current = new Chart(ctx, {
                        type: 'radar',
                        data: {
                            labels: ['反叛', '智性', '审美', '自由', '意志'],
                            datasets: [{ data: result.stats, backgroundColor: 'rgba(53, 175, 203, 0.1)', borderColor: COLORS.accentBlue, borderWidth: 1, pointRadius: 0 }]
                        },
                        options: { scales: { r: { angleLines: { display: false }, grid: { color: 'rgba(0,0,0,0.05)' }, ticks: { display: false }, min: 0, max: 100 } }, plugins: { legend: { display: false } } }
                    });
                }
            }, [step, result]);

            const saveAsImage = async () => {
                if (typeof html2canvas === 'undefined') return;
                setIsSaving(true);
                try {
                    const canvas = await html2canvas(captureRef.current, { scale: 2, backgroundColor: COLORS.bg, useCORS: true });
                    const link = document.createElement('a');
                    link.download = `文学原型报告-${result.name}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                } catch (err) { console.error(err); }
                setIsSaving(false);
            };

            return (
                <div className="max-w-xl mx-auto px-4 py-8 min-h-screen">
                    {step === 'welcome' && (
                        <div className="animate-fade-in text-center space-y-12">
                            <div className="text-left pt-6">
                                <div className="inline-block px-3 py-1 bg-[#35afcb] text-white text-[9px] tracking-widest font-sans mb-4 transform -rotate-2">Psychographic Assessment</div>
                                <h1 className="text-4xl md:text-5xl font-light leading-tight tracking-widest text-[#3a3833]">寻找你的<br /><span className="font-bold border-b-4 border-[#e8ed2a]">作家人格</span></h1>
                            </div>
                            <div className="w-full max-w-[340px] mx-auto aspect-[4/3.5] relative">
                                <JarIllustration />
                            </div>
                            <div className="space-y-10">
                                <p className="text-xs text-[#6d6b64] leading-relaxed tracking-wider px-6 font-light italic">“文学不是修辞的点缀，而是你在精神废墟上，重建主体性的最后一次存证。”</p>
                                <div className={`space-y-4 ${showError ? 'shake' : ''}`}>
                                    <div className="flex flex-col items-center gap-2">
                                        <span className="text-[10px] uppercase tracking-[0.3em] opacity-40 font-bold">通行码认证 / ACCESS CODE</span>
                                        <input type="text" value={code} onChange={(e) => setCode(e.target.value)} className="redeem-input w-48 py-2 text-sm text-center" placeholder="请输入通行码" />
                                    </div>
                                </div>
                                <button onClick={handleVerify} className="w-full py-6 bg-[#3a3833] text-white text-[11px] tracking-[0.8em] font-bold flex items-center justify-center transition-all shadow-lg active:scale-95">开启漫游 / LAUNCH</button>
                                <div className="text-[10px] text-gray-400 tracking-[0.3em]">Curated by @云树cloudtree</div>
                            </div>
                        </div>
                    )}

                    {step === 'quiz' && (
                        <div className="animate-fade-in space-y-8 text-center">
                            <div className="flex justify-between items-center border-b border-[#dcd8cf] pb-4">
                                <button onClick={handleBack} className="flex items-center gap-1 text-[10px] uppercase opacity-40 hover:opacity-100 transition-all">BACK</button>
                                <span className="text-[9px] uppercase text-[#6d6b64] font-bold tracking-widest">Step {String(currentQuestion + 1).padStart(2, '0')} / 30</span>
                                <div className="w-10"></div>
                            </div>
                            <h2 className="text-lg md:text-xl leading-relaxed min-h-[140px] flex items-center justify-center italic px-4 border-l border-r border-[#dcd8cf]">{QUESTIONS[currentQuestion].text}</h2>
                            <div className="space-y-4 text-left">
                                {QUESTIONS[currentQuestion].options.map((option, idx) => (
                                    <button key={idx} onClick={() => handleAnswer(option.type)} className="w-full p-6 bg-white bg-opacity-70 rounded-[12px] border border-[#dcd8cf] hover:border-[#3a3833] transition-all text-left group shadow-sm active:bg-white">
                                        <span className="text-[14px] text-[#6d6b64] group-hover:text-[#3a3833] leading-relaxed pr-4">{option.text}</span>
                                    </button>
                                ))}
                            </div>
                            <div className="pt-10 flex justify-center"><div className="h-[1px] w-48 bg-[#dcd8cf] relative"><div className="h-full bg-[#3a3833] transition-all duration-700" style={{width: `${((currentQuestion+1)/30)*100}%`}}></div></div></div>
                        </div>
                    )}

                    {step === 'result' && result && (
                        <div className="animate-fade-in space-y-8 pb-12">
                            <div ref={captureRef} className="p-4 space-y-12 bg-[#f2f0e9]">
                                <div className="text-center space-y-6 py-12 bg-white border border-[#dcd8cf] rounded-sm shadow-sm relative overflow-hidden">
                                    <span className="text-[10px] font-bold uppercase tracking-[0.5em] text-[#35afcb]">Literature Archetype Profile</span>
                                    <h2 className="text-3xl md:text-4xl font-bold text-[#3a3833] tracking-widest px-2">{result.name}</h2>
                                    <p className="text-sm text-[#35afcb] italic tracking-[0.4em]">{result.sub}</p>
                                    <div className="flex justify-center gap-4 pt-4">
                                        <span className="px-3 py-1 border border-[#3a3833] text-[9px] font-bold uppercase">思辨觉醒度 98%</span>
                                        <span className="px-3 py-1 bg-[#3a3833] text-white text-[9px] font-bold uppercase">主体性存证</span>
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white p-8 border border-[#dcd8cf] relative">
                                    <div className="absolute -top-3 -right-3 px-3 py-1 bg-white border border-[#3a3833] text-[10px] font-bold transform rotate-3 shadow-sm">NO. 2026-Soul</div>
                                    <div className="space-y-4 text-left">
                                        <h4 className="text-[11px] font-bold border-b pb-2 text-left">叙事基因分析报告</h4>
                                        <div className="space-y-3 text-[10px]">
                                            <div className="flex justify-between items-center"><span>感性/意志</span><div className="w-24 h-1 bg-gray-100"><div className="h-full bg-[#e8ed2a]" style={{width:'85%'}}></div></div></div>
                                            <div className="flex justify-between items-center"><span>理性/逻辑</span><div className="w-24 h-1 bg-gray-100"><div className="h-full bg-[#35afcb]" style={{width:'40%'}}></div></div></div>
                                            <div className="flex justify-between items-center"><span>自由/反叛</span><div className="w-24 h-1 bg-gray-100"><div className="h-full bg-black" style={{width:'70%'}}></div></div></div>
                                        </div>
                                    </div>
                                    <div className="aspect-square w-full max-w-[200px] mx-auto">
                                        <canvas ref={radarCanvas}></canvas>
                                    </div>
                                </div>

                                <div className="relative p-12 bg-white border border-[#dcd8cf] text-center shadow-sm">
                                    <p className="text-xl leading-relaxed mb-6 font-medium text-center"><span className="highlight-yellow">{result.quote}</span></p>
                                    <div className="text-[10px] text-[#a4c29b] tracking-widest uppercase font-bold text-center">— {result.quoteSource} —</div>
                                </div>

                                <div className="space-y-10 px-2 text-left">
                                    <section className="space-y-4">
                                        <h4 className="text-[11px] font-bold uppercase tracking-[0.5em] border-b border-[#dcd8cf] pb-2">灵魂本色 / THE SELF</h4>
                                        <div className="bg-white p-6 border-l-4 border-[#35afcb] space-y-4 text-left">
                                            <p className="text-[13px] leading-relaxed text-[#6d6b64] italic">“{result.identity}”</p>
                                            <p className="text-[13px] leading-relaxed font-light">{result.longDesc}</p>
                                        </div>
                                    </section>
                                    <section className="space-y-4 text-left">
                                        <h4 className="text-[11px] font-bold uppercase tracking-[0.5em] border-b border-[#dcd8cf] pb-2 text-red-800">核心焦虑与盲区</h4>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-[12px]">
                                            <div className="p-4 bg-red-50 border border-red-100 rounded text-left">
                                                <div className="font-bold mb-1">主导焦虑</div>
                                                <div className="opacity-70">{result.anxiety}</div>
                                            </div>
                                            <div className="p-4 bg-gray-50 border border-gray-100 rounded text-left">
                                                <div className="font-bold mb-1">阴影面</div>
                                                <div className="opacity-70">{result.shadow}</div>
                                            </div>
                                        </div>
                                    </section>
                                    <section className="space-y-6">
                                        <h4 className="text-[11px] font-bold uppercase tracking-[0.5em] border-b border-[#dcd8cf] pb-2 text-left">思想进阶书单推荐</h4>
                                        <div className="grid gap-4">
                                            {result.books && result.books.map((book, i) => (
                                                <div key={i} className="bg-white p-6 border border-[#dcd8cf] relative group shadow-sm text-left">
                                                    <h5 className="text-[15px] font-bold mb-1">{book.title}</h5>
                                                    <p className="text-[10px] text-[#a4c29b] font-bold mb-2 uppercase">作者: {book.author}</p>
                                                    <p className="text-xs text-[#6d6b64] italic leading-relaxed opacity-80">{book.desc}</p>
                                                </div>
                                            ))}
                                        </div>
                                    </section>
                                </div>
                            </div>
                            <div className="pt-8 space-y-4 text-center px-4">
                                <button onClick={saveAsImage} disabled={isSaving} className="w-full py-5 bg-black text-white text-[11px] font-bold uppercase tracking-[0.5em] flex items-center justify-center gap-3 shadow-xl active:bg-gray-800 disabled:opacity-50 transition-all">{isSaving ? "生成中..." : "保存手稿报告 / SAVE REPORT"}</button>
                                <button onClick={handleRestart} className="w-full py-5 border border-[#3a3833] text-[11px] font-bold uppercase tracking-[0.5em] hover:bg-[#3a3833] hover:text-white transition-all">再次重塑原型</button>
                            </div>
                        </div>
                    )}
                    <footer className="mt-16 pt-16 border-t border-[#dcd8cf] text-center space-y-4">
                        <p className="text-[10px] tracking-[0.6em] uppercase text-[#3a3833] font-bold opacity-60">© 2026 CURATED BY @云树CLOUDTREE</p>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
